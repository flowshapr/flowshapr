# =============================================================================
# FLOWSHAPR PRODUCTION ENVIRONMENT CONFIGURATION
# =============================================================================
# This file contains all environment variables needed for production deployment
# Copy this to .env.production and fill in your actual values
# Some variables use Coolify magic variables for automatic configuration

# =============================================================================
# APPLICATION CONFIGURATION
# =============================================================================
NODE_ENV=production

# Frontend Configuration
FRONTEND_URL=https://app.flowshapr.ai
NEXT_PUBLIC_APP_URL=https://app.flowshapr.ai

# Backend Configuration
API_URL=https://api.flowshapr.ai
BACKEND_URL=https://api.flowshapr.ai
PORT=3001

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# Coolify will automatically provide DATABASE_URL via magic variable
COOLIFY_DATABASE_URL=${COOLIFY_DATABASE_URL}

# Manual database configuration (if not using Coolify magic variable)
DB_HOST=postgres
DB_PORT=5432
DB_NAME=flowshapr
DB_USER=flowshapr
DB_PASSWORD=${DB_PASSWORD:-your-secure-db-password}

# Full database URL (constructed automatically in production)
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# =============================================================================
# AUTHENTICATION CONFIGURATION
# =============================================================================
# Better Auth Secret (generate with: openssl rand -base64 32)
BETTER_AUTH_SECRET=${BETTER_AUTH_SECRET:-your-32-character-secret-key}
BETTER_AUTH_URL=${API_URL}
NEXT_PUBLIC_BETTER_AUTH_URL=${API_URL}

# =============================================================================
# SOCIAL AUTHENTICATION PROVIDERS
# =============================================================================
# Google OAuth
GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID}
GOOGLE_CLIENT_SECRET=${GOOGLE_CLIENT_SECRET}
NEXT_PUBLIC_GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID}

# GitHub OAuth
GITHUB_CLIENT_ID=${GITHUB_CLIENT_ID}
GITHUB_CLIENT_SECRET=${GITHUB_CLIENT_SECRET}
NEXT_PUBLIC_GITHUB_CLIENT_ID=${GITHUB_CLIENT_ID}

# Microsoft OAuth
MICROSOFT_CLIENT_ID=${MICROSOFT_CLIENT_ID}
MICROSOFT_CLIENT_SECRET=${MICROSOFT_CLIENT_SECRET}
NEXT_PUBLIC_MICROSOFT_CLIENT_ID=${MICROSOFT_CLIENT_ID}

# Apple OAuth
APPLE_CLIENT_ID=${APPLE_CLIENT_ID}
APPLE_CLIENT_SECRET=${APPLE_CLIENT_SECRET}
NEXT_PUBLIC_APPLE_CLIENT_ID=${APPLE_CLIENT_ID}

# =============================================================================
# GOOGLE ANALYTICS CONFIGURATION
# =============================================================================
NEXT_PUBLIC_GA_TRACKING_ID=${GA_TRACKING_ID:-G-VKBL864K6V}

# =============================================================================
# AI PROVIDER API KEYS
# =============================================================================
# Google AI (Gemini) - Primary provider
GOOGLE_AI_API_KEY=${GOOGLE_AI_API_KEY}
GEMINI_API_KEY=${GOOGLE_AI_API_KEY}
GOOGLE_GENAI_API_KEY=${GOOGLE_AI_API_KEY}

# OpenAI API Key
OPENAI_API_KEY=${OPENAI_API_KEY:-optional-openai-key}

# Anthropic (Claude) API Key
ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-optional-anthropic-key}

# =============================================================================
# CORS AND SECURITY CONFIGURATION
# =============================================================================
CORS_ORIGIN=${FRONTEND_URL}
CORS_CREDENTIALS=true

# Security headers
SECURE_HEADERS=true
RATE_LIMIT_ENABLED=true

# =============================================================================
# CONTAINER EXECUTOR CONFIGURATION
# =============================================================================
CONTAINER_EXECUTOR_TIMEOUT=${CONTAINER_EXECUTOR_TIMEOUT:-60000}
MAX_CONCURRENT_CONTAINERS=${MAX_CONCURRENT_CONTAINERS:-10}
CONTAINER_MEMORY_LIMIT=1g
CONTAINER_CPU_LIMIT=1.0

# Docker configuration
DOCKER_HOST=unix:///var/run/docker.sock
GENKIT_EXECUTOR_IMAGE=flowshapr-genkit-executor

# =============================================================================
# RATE LIMITING CONFIGURATION
# =============================================================================
RATE_LIMIT_WINDOW_MS=${RATE_LIMIT_WINDOW_MS:-900000}  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=${RATE_LIMIT_MAX_REQUESTS:-100}  # 100 requests per window

# API Rate Limits
API_RATE_LIMIT_WINDOW_MS=60000  # 1 minute
API_RATE_LIMIT_MAX_REQUESTS=60  # 60 requests per minute

# Flow execution rate limits
FLOW_EXECUTION_RATE_LIMIT_WINDOW_MS=300000  # 5 minutes
FLOW_EXECUTION_RATE_LIMIT_MAX_REQUESTS=20   # 20 executions per 5 minutes

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
LOG_LEVEL=${LOG_LEVEL:-info}
LOG_FORMAT=json
LOG_FILE_ENABLED=true
LOG_FILE_PATH=/app/logs/application.log
LOG_FILE_MAX_SIZE=100m
LOG_FILE_MAX_FILES=10

# =============================================================================
# SESSION CONFIGURATION
# =============================================================================
SESSION_SECRET=${SESSION_SECRET:-your-session-secret-key}
SESSION_MAX_AGE=86400000  # 24 hours in milliseconds
SESSION_SECURE=true       # HTTPS only in production
SESSION_SAME_SITE=strict

# =============================================================================
# TELEMETRY AND MONITORING
# =============================================================================
TELEMETRY_ENABLED=true
TELEMETRY_ENDPOINT=${API_URL}/api/telemetry

# Health check configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30000  # 30 seconds

# =============================================================================
# FILE UPLOAD CONFIGURATION
# =============================================================================
MAX_FILE_SIZE=10485760  # 10MB in bytes
ALLOWED_FILE_TYPES=.json,.txt,.csv,.md
UPLOAD_PATH=/app/uploads

# =============================================================================
# EMAIL CONFIGURATION (if needed)
# =============================================================================
SMTP_HOST=${SMTP_HOST:-optional-smtp-host}
SMTP_PORT=${SMTP_PORT:-587}
SMTP_USER=${SMTP_USER:-optional-smtp-user}
SMTP_PASSWORD=${SMTP_PASSWORD:-optional-smtp-password}
SMTP_FROM_EMAIL=${SMTP_FROM_EMAIL:-noreply@flowshapr.ai}

# =============================================================================
# FEATURE FLAGS
# =============================================================================
FEATURE_USER_REGISTRATION=true
FEATURE_SOCIAL_AUTH=true
FEATURE_FLOW_SHARING=true
FEATURE_ANALYTICS=true
FEATURE_BETA_FEATURES=false

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=${BACKUP_S3_BUCKET:-optional-backup-bucket}
BACKUP_S3_REGION=${BACKUP_S3_REGION:-us-east-1}
BACKUP_S3_ACCESS_KEY_ID=${BACKUP_S3_ACCESS_KEY_ID:-optional}
BACKUP_S3_SECRET_ACCESS_KEY=${BACKUP_S3_SECRET_ACCESS_KEY:-optional}

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================
# Node.js performance tuning
NODE_OPTIONS="--max-old-space-size=2048"

# Database connection pool
DB_POOL_MIN=5
DB_POOL_MAX=20
DB_POOL_IDLE_TIMEOUT=30000

# Cache configuration
CACHE_TTL=300000  # 5 minutes
CACHE_MAX_SIZE=100  # Maximum number of cached items

# =============================================================================
# DEVELOPMENT OVERRIDES (remove in production)
# =============================================================================
# These should be removed or set to false/disabled in production
NEXT_TELEMETRY_DISABLED=1
DEBUG=false